<Window x:Class="FileManagerSystem.View.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"

        xmlns:vm="clr-namespace:FileManagerSystem.ViewModel"

        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        d:DataContext="{d:DesignInstance Type=vm:MainViewModel}"

        Title="File System Manager" Height="650" Width="950"
        Background="#F5F5F7" WindowStartupLocation="CenterScreen"
        FontFamily="Segoe UI, Malgun Gothic"
        Icon="FAPLUS.ico">

    <Window.Resources>
        <vm:StatusToBrushConverter x:Key="StatusToBrushConverter"/>
        <vm:StatusToTextConverter x:Key="StatusToTextConverter"/>
        <Style x:Key="ModernBtn" TargetType="Button">
            <Setter Property="Background" Value="#E1E1E1"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>

            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#D1D1D1"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="ModernProgress" TargetType="ProgressBar">
            <Setter Property="Background" Value="#E0E0E0"/>
            <Setter Property="Foreground" Value="#0078D7"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Height" Value="12"/>
        </Style>
    </Window.Resources>

    <Grid Margin="30">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <RowDefinition Height="Auto"/> <RowDefinition Height="Auto"/> <RowDefinition Height="*"/>    <RowDefinition Height="Auto"/> </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Margin="0,0,0,25">
            <TextBlock Text="File System Manager" FontSize="28" FontWeight="ExtraBold" Foreground="#1A1A1A"/>
            <TextBlock Text="Automated file cleanup and archiving system" Foreground="#666666" FontSize="14" Margin="2,2,0,0"/>
        </StackPanel>

        <Border Grid.Row="1" Background="White" CornerRadius="12" Padding="20" Margin="0,0,0,20">
            <Border.Effect>
                <DropShadowEffect BlurRadius="15" ShadowDepth="2" Opacity="0.05" Color="Black"/>
            </Border.Effect>
            <StackPanel>
                <TextBlock Text="DIRECTORY SETTINGS" FontSize="12" FontWeight="Bold" Foreground="#0078D7" Margin="0,0,0,15"/>

                <Grid Margin="0,5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="90"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Source Directory" VerticalAlignment="Center" Foreground="#444444"/>
                    <TextBox Grid.Column="1" Text="{Binding StorageVM.SourcePath}" Padding="8" Background="#F9F9F9" BorderBrush="#E0E0E0"/>
                    <Button Grid.Column="2" Content="Browse" Style="{StaticResource ModernBtn}" Command="{Binding StorageVM.SelectSourceCommand}" Margin="8,0,0,0"/>
                </Grid>

                <Grid Margin="0,10,0,5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="140"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="90"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Archive Directory" VerticalAlignment="Center" Foreground="#444444"/>
                    <TextBox Grid.Column="1" Text="{Binding StorageVM.TargetPath}" Padding="8" Background="#F9F9F9" BorderBrush="#E0E0E0"/>
                    <Button Grid.Column="2" Content="Browse" Style="{StaticResource ModernBtn}" Command="{Binding StorageVM.SelectTargetCommand}" Margin="8,0,0,0"/>
                </Grid>

                <Separator Background="#F0F0F0" Margin="0,15,0,15"/>
                <Button Content="RUN MANUAL BACKUP NOW"
                Command="{Binding StorageVM.ManualArchiveCommand}"
                HorizontalAlignment="Right"
                Padding="20,8"
                Background="#F9F9F9"
                Foreground="#0078D7"
                FontWeight="Bold"
                BorderBrush="#0078D7"
                BorderThickness="1">
                    <Button.Resources>
                        <Style TargetType="Border">
                            <Setter Property="CornerRadius" Value="4"/>
                        </Style>
                    </Button.Resources>
                </Button>
            </StackPanel>
        </Border>

        <Grid Grid.Row="2" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="280"/>
            </Grid.ColumnDefinitions>

            <Border Grid.Column="0" Background="White" CornerRadius="12" Padding="20" Margin="0,0,15,0">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="15" ShadowDepth="2" Opacity="0.05" Color="Black"/>
                </Border.Effect>
                <StackPanel VerticalAlignment="Center">
                    <Grid Margin="0,0,0,10">
                        <TextBlock Text="Current Storage Usage" FontWeight="Bold" Foreground="#444444"/>
                        <TextBlock HorizontalAlignment="Right">
                            <Run Text="{Binding StorageVM.CurrentCapacityGB, StringFormat={}{0:N2}}" FontWeight="Bold" Foreground="#1A1A1A"/>
                            <Run Text=" / " Foreground="#999999"/>
                            <Run Text="{Binding StorageVM.MaxCapacityGB}" Foreground="#666666"/>
                            <Run Text=" GB" Foreground="#999999"/>
                        </TextBlock>
                    </Grid>
                    <ProgressBar Value="{Binding StorageVM.CapacityPercent}" Style="{StaticResource ModernProgress}"/>
                </StackPanel>
            </Border>

            <Border Grid.Column="1" Background="#0078D7" CornerRadius="12" Padding="20">
                <StackPanel VerticalAlignment="Center">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Margin="0,0,10,0">
                            <TextBlock Text="Limit (GB)" Foreground="#CCFFFFFF" FontSize="11" FontWeight="Bold" Margin="0,0,0,5"/>
                            <TextBox Text="{Binding StorageVM.MaxCapacityGB}" FontSize="18" FontWeight="Bold" TextAlignment="Center"
                         Background="Transparent" Foreground="White" BorderThickness="0,0,0,2" BorderBrush="#88FFFFFF"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Margin="10,0,0,0">
                            <TextBlock Text="Buffer (GB)" Foreground="#CCFFFFFF" FontSize="11" FontWeight="Bold" Margin="0,0,0,5"/>
                            <TextBox Text="{Binding StorageVM.CleanupBufferGB}" FontSize="18" FontWeight="Bold" TextAlignment="Center"
                         Background="Transparent" Foreground="White" BorderThickness="0,0,0,2" BorderBrush="#88FFFFFF"/>
                        </StackPanel>
                    </Grid>

                    <Button Command="{Binding StorageVM.ToggleEngineCommand}"
                        Height="35"
                        Background="{Binding StorageVM.EngineColor}"
                        Foreground="{Binding StorageVM.IsRunning, Converter={StaticResource StatusToBrushConverter}}"
                        FontWeight="Bold"
                        Margin="0,20,0,0">
                        <Button.Content>
                            <TextBlock Text="{Binding StorageVM.EngineText}"/>
                        </Button.Content>
                        <Button.Resources>
                            <Style TargetType="Border">
                                <Setter Property="CornerRadius" Value="6"/>
                            </Style>
                        </Button.Resources>
                    </Button>
                </StackPanel>
            </Border>
        </Grid>

        <Border Grid.Row="3" Background="White" CornerRadius="12" Padding="15">
            <Border.Effect>
                <DropShadowEffect BlurRadius="15" ShadowDepth="2" Opacity="0.05" Color="Black"/>
            </Border.Effect>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBlock Grid.Row="0" Text="System Activities" FontSize="12" FontWeight="Bold" Foreground="#666666" Margin="5,0,0,10"/>
                <ListBox Grid.Row="1" ItemsSource="{Binding StorageVM.logVm.LogMessages}" BorderThickness="0" Background="Transparent">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Margin="0,3">
                                <TextBlock Text="{Binding Timestamp}" Foreground="#999999" Margin="0,0,10,0"/>
                                <TextBlock Text="{Binding Message}" Foreground="#333333"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </Border>

        <StatusBar Grid.Row="4" Background="Transparent" Margin="0,15,0,0">
            <StackPanel Orientation="Horizontal">
                <Ellipse Width="8" Height="8" Fill="#4CAF50" Margin="0,0,8,0"/>
                <TextBlock Text="System Healthy" Foreground="#999999" FontSize="11"/>
            </StackPanel>
        </StatusBar>
    </Grid>
</Window>